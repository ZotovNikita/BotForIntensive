{"version":3,"file":"angular-chat-widget-rasa.js.map","sources":["ng://angular-chat-widget-rasa/lib/chat-avatar/chat-avatar.component.ts","ng://angular-chat-widget-rasa/lib/animations.ts","ng://angular-chat-widget-rasa/lib/chatbot-rasa.service.ts","ng://angular-chat-widget-rasa/lib/chat-widget/chat-widget.component.ts","ng://angular-chat-widget-rasa/lib/chat-input/chat-input.component.ts","ng://angular-chat-widget-rasa/lib/chat-config/chat-config.component.ts","ng://angular-chat-widget-rasa/lib/chatbot-rasa.module.ts"],"sourcesContent":["import { Component, Input } from '@angular/core'\n\n@Component({\n  selector: 'chat-avatar',\n  template: `\n    <img [attr.src]=\"image\" class=\"avatar\" />\n  `,\n  styles: [`\n    .avatar {\n      height: 30px;\n      width: 30px;\n      border-radius: 50%;\n      float: left;\n      margin-right: 10px;\n    }\n  `]\n})\nexport class ChatAvatarComponent {\n  @Input() public image: string\n}\n","import { animate, style, transition, trigger } from '@angular/animations'\n\nexport const fadeInOut = trigger('fadeInOut', [\n  transition(':enter', [\n    style({opacity: 0}),\n    animate(250 )\n  ]),\n  transition('* => void', [\n    animate(250, style({\n      opacity: 0,\n    }))\n  ])\n])\n\nexport const fadeIn = trigger('fadeIn', [\n  transition(':enter', [\n    style({opacity: 0}),\n    animate(500 )\n  ]),\n  transition(':leave', [\n    style({opacity: 0}),\n    animate(1 )\n  ]),\n])\n","import { Injectable } from '@angular/core';\nimport io from 'socket.io-client';\nimport { Observable } from 'rxjs/Observable';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n\n  private socket;\n\n  constructor() {\n\n  }\n\n  public connect(url: string){\n    this.socket = io(url);\n    this.socket.on('connect', () => {\n      this.socket.emit('session_request', {'session_id':this.socket.id})\n    });\n    this.socket.on('session_confirm', (remote_id) => {\n    })\n    this.socket.on('connect_error', (error) => {\n      console.log(error);\n    });\n\n    this.socket.on('error', (error) => {\n      console.log(error);\n    });\n\n    this.socket.on('disconnect', (reason) => {\n      console.log(reason);\n    });\n  }\n\n  public sendMessage(message) {\n    this.socket.emit('user_uttered', {'message':message});\n  }\n\n  public getMessages = () => {\n        return Observable.create((observer) => {\n            this.socket.on('bot_uttered', (message) => {\n                observer.next(message);\n            });\n        });\n  }\n}\n","import { Component, ElementRef, HostListener, Input, OnInit, ViewChild } from '@angular/core'\nimport { Subject } from 'rxjs'\nimport { fadeIn, fadeInOut } from '../animations'\nimport { ChatService } from '../chatbot-rasa.service';\n\nconst rand = max => Math.floor(Math.random() * max)\n\n@Component({\n  selector: 'chat-widget',\n  templateUrl: './chat-widget.component.html',\n  styleUrls: ['./chat-widget.component.css'],\n  animations: [fadeInOut, fadeIn],\n})\nexport class ChatWidgetComponent implements OnInit {\n  @ViewChild('bottom') bottom: ElementRef\n  @Input() public theme: 'blue' | 'grey' | 'red' = 'blue'\n  @Input() public botName: string = 'Bot';\n  @Input() public botAvatar: string = `https://cdn.dribbble.com/users/275794/screenshots/3128598/gbot_800.png`\n  @Input() public userAvatar: string = `https://storage.proboards.com/6172192/images/gKhXFw_5W0SD4nwuMev1.png`\n  @Input() public url: string = 'http://localhost:5002'\n  @Input() public startingMessage: string = 'Hi, how can we help you?'\n  @Input() public opened: boolean = true\n\n  public _visible = false\n\n  private chatService: ChatService;\n\n  constructor(chatService: ChatService) {\n    this.chatService = chatService;\n    this.chatService.connect(this.url);\n  }\n\n  public get visible() {\n    return this._visible\n  }\n\n  @Input() public set visible(visible) {\n    this._visible = visible\n    if (this._visible) {\n      setTimeout(() => {\n        this.scrollToBottom()\n        this.focusMessage()\n      }, 0)\n    }\n  }\n\n  public focus = new Subject()\n\n  public operator;\n\n  public client;\n\n  public messages = []\n\n  public addMessage(from, text, type: 'received' | 'sent') {\n    this.messages.unshift({\n      from,\n      text,\n      type,\n      date: new Date().getTime(),\n    })\n    this.scrollToBottom()\n  }\n\n  public scrollToBottom() {\n    if (this.bottom !== undefined) {\n      this.bottom.nativeElement.scrollIntoView()\n    }\n  }\n\n  public focusMessage() {\n    this.focus.next(true)\n  }\n\n  ngOnInit() {\n    this.client = {\n      name: 'Guest User',\n      status: 'online',\n      avatar: this.userAvatar,\n    };\n\n    this.operator  = {\n      name: this.botName,\n      status: 'online',\n      avatar: this.botAvatar,\n    };\n    if(this.opened){\n      setTimeout(() => this.visible = true, 1000)\n    }\n    setTimeout(() => {\n      this.addMessage(this.operator, this.startingMessage, 'received')\n    }, 1500)\n    this.chatService\n      .getMessages()\n      .subscribe((message) => {\n        setTimeout(()=> {this.addMessage(this.operator, message.text, 'received')},1000);\n      });\n  }\n\n  public toggleChat() {\n    this.visible = !this.visible\n  }\n\n  public sendMessage({ message }) {\n    if (message.trim() === '') {\n      return\n    }\n    this.addMessage(this.client, message, 'sent')\n    this.chatService.sendMessage(message)\n  }\n\n  @HostListener('document:keypress', ['$event'])\n  handleKeyboardEvent(event: KeyboardEvent) {\n    if (event.key === '/') {\n      this.focusMessage()\n    }\n    if (event.key === '?' && !this._visible) {\n      this.toggleChat()\n    }\n  }\n\n}\n","import { Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild, ViewEncapsulation } from '@angular/core'\n\n@Component({\n  selector: 'chat-input',\n  template: `\n    <textarea type=\"text\" class=\"chat-input-text\" placeholder=\"Type message...\"\n              #message (keydown.enter)=\"onSubmit()\" (keyup.enter)=\"message.value = ''\" (keyup.escape)=\"dismiss.emit()\"></textarea>\n    <button type=\"submit\" class=\"chat-input-submit\" (click)=\"onSubmit()\">\n      {{buttonText}}\n    </button>\n  `,\n  encapsulation: ViewEncapsulation.None,\n  styleUrls: ['./chat-input.component.css'],\n})\nexport class ChatInputComponent implements OnInit {\n  @Input() public buttonText = 'â©ï¸'\n  @Input() public focus = new EventEmitter()\n  @Output() public send = new EventEmitter()\n  @Output() public dismiss = new EventEmitter()\n  @ViewChild('message') message: ElementRef\n\n  ngOnInit() {\n    this.focus.subscribe(() => this.focusMessage())\n  }\n\n  public focusMessage() {\n    this.message.nativeElement.focus()\n  }\n\n  public getMessage() {\n    return this.message.nativeElement.value\n  }\n\n  public clearMessage() {\n    this.message.nativeElement.value = ''\n  }\n\n  onSubmit() {\n    const message = this.getMessage()\n    if (message.trim() === '') {\n      return\n    }\n    this.send.emit({ message })\n    this.clearMessage()\n    this.focusMessage()\n  }\n\n}\n","import { Component, EventEmitter, Input, Output } from '@angular/core'\n\n@Component({\n  selector: 'chat-config',\n  template: `\n    <div class=\"chat-config\">\n      {{text}}\n      <button *ngFor=\"let item of themes\"\n              class=\"btn\" [class.btn-active]=\"item === theme\"\n              (click)=\"setTheme(item)\">\n        {{item}}\n      </button>\n    </div>\n  `,\n  styles: [`\n    .chat-config {\n      padding: 20px;\n    }\n    .btn {\n      padding: 5px;\n      margin: 0px 2px;\n      border: 1px solid #dedede;\n      outline: none;\n    }\n    .btn-active {\n      border: 1px solid #a0a0a0;\n    }\n    .btn:focus {\n      border: 1px solid #333;\n    }\n  `],\n})\nexport class ChatConfigComponent {\n  @Input() public theme: string\n  @Input() public text = 'Select theme'\n  @Output() public themeChange: EventEmitter<any> = new EventEmitter()\n\n  public themes = ['blue', 'grey', 'red']\n  public setTheme(theme) {\n    this.theme = theme\n    this.themeChange.emit(this.theme)\n  }\n}\n","import { NgModule } from '@angular/core'\nimport { CommonModule } from '@angular/common'\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations'\nimport { ChatAvatarComponent } from './chat-avatar/chat-avatar.component'\nimport { ChatWidgetComponent } from './chat-widget/chat-widget.component'\nimport { ChatInputComponent } from './chat-input/chat-input.component'\nimport { ChatConfigComponent } from './chat-config/chat-config.component'\nimport { ChatService } from './chatbot-rasa.service';\n\n@NgModule({\n  imports: [CommonModule, BrowserAnimationsModule],\n  declarations: [ChatAvatarComponent, ChatWidgetComponent, ChatInputComponent, ChatConfigComponent],\n  exports: [ChatWidgetComponent, ChatConfigComponent],\n  entryComponents: [ChatWidgetComponent, ChatConfigComponent],\n  providers: [ChatService]\n})\nexport class ChatbotRasaModule { }\n"],"names":[],"mappings":"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"}
